<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fabdive - Rencontres par affinités</title>
    <link rel="icon" href="/favicon_fabdive.png" type="image/png">
    <meta name="description" content="Choisis tes cartes, laisse parler tes affinités, révèle toi à ton rythme" />
    <meta name="author" content="Lovable" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#8b5cf6">
    <link rel="apple-touch-icon" href="/fabdive-icon.png">

    <meta property="og:title" content="FabDive - Rencontres par affinités" />
    <meta property="og:description" content="Choisis tes cartes, laisse parler tes affinités, révèle toi à ton rythme" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://fabdive.app/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="https://fabdive.app/opengraph-image-p98pqg.png" />
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx?v=20250909-cache-kill"></script>
    <script>
      // Solution ULTRA AGRESSIVE pour éliminer définitivement le cache mobile
      const timestamp = Date.now();
      const randomKey = Math.random().toString(36);
      
      console.log('CACHE KILLER v4.0:', timestamp, randomKey);
      
      // Nettoyer TOUT au chargement
      window.addEventListener('load', () => {
        // Détruire tous les service workers
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.getRegistrations().then(function(registrations) {
            for(let registration of registrations) {
              registration.unregister();
            }
          });
        }
        
        // Vider tous les caches
        if ('caches' in window) {
          caches.keys().then(function(names) {
            for (let name of names) {
              caches.delete(name);
            }
          });
        }
        
        // Forcer rechargement si cache détecté - MEGA VERSION
        const lastTimestamp = localStorage.getItem('lastCacheKill');
        const now = timestamp.toString();
        
        if (!lastTimestamp || timestamp - parseInt(lastTimestamp) > 10000) {
          localStorage.setItem('lastCacheKill', now);
          localStorage.setItem('cacheVersion', randomKey);
          console.log('FORCING RELOAD - Cache detected');
          setTimeout(() => {
            window.location.reload(true);
          }, 100);
        }
      });
      
      // Headers anti-cache ULTRA
      if ('fetch' in window) {
        const originalFetch = window.fetch;
        window.fetch = function(...args) {
          const url = args[0];
          const options = args[1] || {};
          if (typeof url === 'string' && (url.includes('.js') || url.includes('.css'))) {
            options.cache = 'no-store';
            options.headers = {
              ...options.headers,
              'Cache-Control': 'no-cache, no-store, must-revalidate',
              'Pragma': 'no-cache',
              'Expires': '0'
            };
          }
          return originalFetch.apply(this, [url, options]);
        };
      }
    </script>
  </body>
</html>
